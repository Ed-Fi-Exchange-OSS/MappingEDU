<!--
SPDX-License-Identifier: Apache-2.0
Licensed to the Ed-Fi Alliance under one or more agreements.
The Ed-Fi Alliance licenses this file to you under the Apache License, Version 2.0.
See the LICENSE and NOTICES files in the project root for more information.
-->

<div ma-handle-errors error-data="elementGroupDetailInfoViewModel.errorData">
</div>
<div class="section-header clearfix">
    <br />
    <div class="title collapsed" data-toggle="collapse" data-target="#entities"
         ng-click="elementGroupDetailInfoViewModel.toggleEntitiesCaret()">
        <div class="toggle-icon fa fa-2x"
             ng-class="{'fa-caret-down': elementGroupDetailInfoViewModel.showEntities,
                    'fa-caret-right': !elementGroupDetailInfoViewModel.showEntities}">
        </div>
        <div class="toggle-text">Entities</div>
    </div>
    <hr />
</div>
<div id="entities" class="collapse in">
    <div class="row">
        <div class="col-md-12">
            <table id="entitiesTable" class="table table-bordered table-striped" datatable="ng">
                <thead>
                    <tr>
                        <th style="width: 30%">Name</th>
                        <th style="width: 60%">Definition</th>
                        <th style="width: 5%" ng-if="elementGroupDetailInfoViewModel.dataStandardId != elementGroupDetailInfoViewModel.emptyGuid">Edit</th>
                        <th style="width: 5%" ng-if="elementGroupDetailInfoViewModel.dataStandardId != elementGroupDetailInfoViewModel.emptyGuid">Delete</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="entity in elementGroupDetailInfoViewModel.elementGroup.Elements | filter: {'ElementDetails': {'ItemType': {'Name': 'Entity'}}}">
                        <td><a ui-sref="{{ entity.nameSref }}">{{ entity.ElementDetails.ItemName }}</a></td>
                        <td>{{ entity.ElementDetails.Definition }}</td>
                        <td ng-if="elementGroupDetailInfoViewModel.dataStandardId != elementGroupDetailInfoViewModel.emptyGuid">
                            <a class="btn btn-edit" ng-click="elementGroupDetailInfoViewModel.edit(entity)" data-toggle="modal" data-target="#itemModal"
                               data-backdrop="static" data-keyboard="false">
                                <i class="fa"></i>
                            </a>
                        </td>
                        <td ng-if="elementGroupDetailInfoViewModel.dataStandardId != elementGroupDetailInfoViewModel.emptyGuid">
                            <a class="btn btn-delete" ma-confirm-action="elementGroupDetailInfoViewModel.delete(entity)">
                                <i class="fa"></i>
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>
            <div class="pull-right">
                <a class="btn btn-edit" data-toggle="modal" data-target="#itemModal"
                   data-backdrop="static" data-keyboard="false" ng-click="elementGroupDetailInfoViewModel.addEntity()"
                   ng-if="elementGroupDetailInfoViewModel.dataStandardId != elementGroupDetailInfoViewModel.emptyGuid">
                    <i class="fa"></i>Add Entity
                </a>
            </div>
        </div>
    </div>
</div>
<div class="section-header clearfix">
    <br />
    <div class="title collapsed" data-toggle="collapse" data-target="#enumerations"
         ng-click="elementGroupDetailInfoViewModel.toggleEnumerationsCaret()">
        <div class="toggle-icon fa fa-2x"
             ng-class="{'fa-caret-down': elementGroupDetailInfoViewModel.showEnumerations,
                    'fa-caret-right': !elementGroupDetailInfoViewModel.showEnumerations}">
        </div>
        <div class="toggle-text">Enumerations</div>
    </div>
    <hr />
</div>
<div id="enumerations" class="collapse in">
    <div class="row">
        <div class="col-md-12">
            <table id="enumerationsTable" class="table table-bordered table-striped" datatable="ng">
                <thead>
                    <tr>
                        <th style="width: 30%">Name</th>
                        <th style="width: 60%">Definition</th>
                        <th style="width: 5%" ng-if="elementGroupDetailInfoViewModel.dataStandardId != elementGroupDetailInfoViewModel.emptyGuid">Edit</th>
                        <th style="width: 5%" ng-if="elementGroupDetailInfoViewModel.dataStandardId != elementGroupDetailInfoViewModel.emptyGuid">Delete</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="enumeration in elementGroupDetailInfoViewModel.elementGroup.Elements | filter: {'ElementDetails': {'ItemType': {'Name': 'Enumeration'}}}">
                        <td><a ui-sref="{{ enumeration.nameSref }}">{{ enumeration.ElementDetails.ItemName }}</a></td>
                        <td>{{ enumeration.ElementDetails.Definition }}</td>
                        <td ng-if="elementGroupDetailInfoViewModel.dataStandardId != elementGroupDetailInfoViewModel.emptyGuid">
                            <a class="btn btn-edit" ng-click="elementGroupDetailInfoViewModel.edit(enumeration)" data-toggle="modal" data-target="#itemModal"
                               data-backdrop="static" data-keyboard="false">
                                <i class="fa"></i>
                            </a>
                        </td>
                        <td ng-if="elementGroupDetailInfoViewModel.dataStandardId != elementGroupDetailInfoViewModel.emptyGuid">
                            <a class="btn btn-delete" ma-confirm-action="elementGroupDetailInfoViewModel.delete(enumeration)">
                                <i class="fa"></i>
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>
            <div class="pull-right">
                <a class="btn btn-edit" data-toggle="modal" data-target="#itemModal"
                   data-backdrop="static" data-keyboard="false" ng-click="elementGroupDetailInfoViewModel.addEnumeration()"
                   ng-if="elementGroupDetailInfoViewModel.dataStandardId != elementGroupDetailInfoViewModel.emptyGuid">
                    <i class="fa"></i>Add Enumeration
                </a>
            </div>
        </div>
    </div>
</div>
<div id="itemModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <span class="page-title" ng-if="!elementGroupDetailInfoViewModel.adding">Edit </span>
                <span class="page-title" ng-if="elementGroupDetailInfoViewModel.adding">Add </span>
                <span class="page-title" ng-if="elementGroupDetailInfoViewModel.isEnumeration">Enumeration</span>
                <span class="page-title" ng-if="!elementGroupDetailInfoViewModel.isEnumeration">Entity</span>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div ma-handle-errors error-data="errorData">
                    </div>
                    <form name="elementForm"
                          ng-submit="elementGroupDetailInfoViewModel.saveElementDetail()"
                          novalidate>

                        <div class="col-md-12 form-group" ma-show-errors ng-if="!elementGroupDetailInfoViewModel.adding">
                            <label class="control-label">Definition</label>
                            <textarea class="form-control"
                                      type="text"
                                      ng-model="elementGroupDetailInfoViewModel.editElement.ElementDetails.Definition"
                                      name="definition"></textarea>
                        </div>

                        <div class="col-md-6 form-group" ma-show-errors>
                            <label class="control-label">Element Name</label>
                            <input class="form-control"
                                   type="text"
                                   ng-model="elementGroupDetailInfoViewModel.editElement.ElementDetails.ItemName"
                                   name="itemName"
                                   required
                                   ng-maxlength="255"
                                   set-focus />
                            <div ng-messages="elementForm.itemName.$error" class="help-block">
                                <div ng-message="required">Entity Name is required.</div>
                                <div ng-message="maxlength">Entity Name is too long.</div>
                            </div>
                        </div>

                        <div class="col-md-12 btn-toolbar row">
                            <div class="pull-right">
                                <button type="button" class="btn btn-cancel"
                                        ng-click="elementGroupDetailInfoViewModel.cancelElementDetail()">
                                    <i class="fa"></i>
                                    Cancel
                                </button>
                                <button type="submit" class="btn btn-happy">
                                    <i class="fa"></i>
                                    Save
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>